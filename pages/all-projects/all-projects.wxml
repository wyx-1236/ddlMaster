<!--pages/all-projects/all-projects.wxml-->
<view class="container">
  <!-- ç­›é€‰å’Œæ’åºæ§åˆ¶ -->
  <view class="controls-section">
    <view class="filter-tabs">
      <view 
        class="filter-tab {{filterStatus === 'all' ? 'active' : ''}}"
        bindtap="toggleFilterStatus"
        data-status="all"
      >
        å…¨éƒ¨
      </view>
      <view 
        class="filter-tab {{filterStatus === 'active' ? 'active' : ''}}"
        bindtap="toggleFilterStatus"
        data-status="active"
      >
        è¿›è¡Œä¸­
      </view>
      <view 
        class="filter-tab {{filterStatus === 'completed' ? 'active' : ''}}"
        bindtap="toggleFilterStatus"
        data-status="completed"
      >
        å·²å®Œæˆ
      </view>
    </view>
    
    <view class="sort-controls">
      <view class="sort-btn" bindtap="toggleSortType">
        <text class="sort-text">æ’åºï¼š{{sortType === 'createdAt' ? 'åˆ›å»ºæ—¶é—´' : (sortType === 'deadline' ? 'æˆªæ­¢æ—¥æœŸ' : 'å®Œæˆè¿›åº¦')}}</text>
        <text class="sort-icon">ğŸ”„</text>
      </view>
      <view class="edit-toggle" bindtap="toggleEditMode">
        {{isEditing ? 'å®Œæˆ' : 'ç¼–è¾‘'}}
      </view>
    </view>
  </view>

  <!-- é¡¹ç›®åˆ—è¡¨ -->
  <view class="projects-section">
    <view class="projects-list">
      <view 
        class="project-item" 
        wx:for="{{filteredProjects}}" 
        wx:key="id"
        bindtap="goToProjectDetail"
        data-id="{{item.id}}"
      >
        <view class="project-header">
          <view class="project-title">{{item.name}}</view>
          <view class="project-status status-{{item.status}}">
            {{item.status === 'active' ? 'è¿›è¡Œä¸­' : 'å·²å®Œæˆ'}}
          </view>
        </view>
        
        <view class="project-progress">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{item.progress}}"></view>
          </view>
          <text class="progress-text">{{item.progress}}% ({{item.completedTasks}}/{{item.totalTasks}})</text>
        </view>
        
        <view class="project-meta">
          <view class="meta-item" wx:if="{{item.deadline}}">
            <text class="meta-label">æˆªæ­¢ï¼š</text>
            <text class="meta-value">{{item.deadline}}</text>
          </view>
          <view class="meta-item">
            <text class="meta-label">åˆ›å»ºï¼š</text>
            <text class="meta-value">{{item.createdAt}}</text>
          </view>
        </view>
        
        
        <view class="project-actions" wx:if="{{isEditing}}" catchtap="true">
          <text class="action-btn" bindtap="editProject" data-id="{{item.id}}">ç¼–è¾‘</text>
          <text class="action-btn delete" bindtap="deleteProject" data-id="{{item.id}}">åˆ é™¤</text>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{filteredProjects.length === 0}}">
      <text class="empty-text">æš‚æ— é¡¹ç›®</text>
      <text class="empty-hint">ç‚¹å‡»å³ä¸Šè§’"+"åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªé¡¹ç›®</text>
    </view>
  </view>
</view>

<!-- æµ®åŠ¨æ·»åŠ æŒ‰é’® -->
<view class="fab" bindtap="goToNewProject">
  <text class="fab-icon">+</text>
</view>
